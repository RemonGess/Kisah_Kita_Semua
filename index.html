<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https://images.unsplash.com; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://www.gstatic.com https://*.firebaseio.com https://*.firebasedatabase.app; font-src 'self' https://cdnjs.cloudflare.com; connect-src 'self' https://*.firebaseio.com https://*.firebasedatabase.app;">
    <title>Kenangan Kita</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-storage-compat.js"></script>
    <style>
        :root {
            --primary-color: #ff6b6b;
            --secondary-color: #ff8e8e;
            --dark-color: #2d3436;
            --light-color: #f8f9fa;
            --text-color: #333;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fa;
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }
        /* Preloader */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s, visibility 0.5s;
        }
        .preloader.hidden {
            opacity: 0;
            visibility: hidden;
        }
        .heart {
            width: 100px;
            height: 100px;
            background-color: var(--primary-color);
            position: relative;
            transform: rotate(45deg);
            animation: heartbeat 1.2s infinite;
        }
        .heart::before,
        .heart::after {
            content: '';
            width: 100px;
            height: 100px;
            position: absolute;
            background-color: var(--primary-color);
            border-radius: 50%;
        }
        .heart::before {
            top: -50px;
            left: 0;
        }
        .heart::after {
            left: -50px;
            top: 0;
        }
        @keyframes heartbeat {
            0% { transform: rotate(45deg) scale(1); }
            20% { transform: rotate(45deg) scale(1.1); }
            40% { transform: rotate(45deg) scale(1); }
            60% { transform: rotate(45deg) scale(1.1); }
            80% { transform: rotate(45deg) scale(1); }
            100% { transform: rotate(45deg) scale(1); }
        }
        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: var(--box-shadow);
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
        }
        .logo i {
            margin-right: 10px;
        }
        .nav-links {
            display: flex;
            list-style: none;
        }
        .nav-links li {
            margin-left: 30px;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }
        .nav-links a:hover {
            opacity: 0.8;
        }
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: white;
            transition: var(--transition);
        }
        .nav-links a:hover::after {
            width: 100%;
        }
        .login-btn, .logout-btn {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid white;
            color: white;
            padding: 8px 15px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }
        .login-btn:hover, .logout-btn:hover {
            background-color: white;
            color: var(--primary-color);
        }
        .logout-btn {
            display: none;
        }
        .logout-btn.active {
            display: block;
        }
        .login-btn.active {
            display: none;
        }
        /* Admin Status */
        .admin-status {
            display: none;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-right: 10px;
        }
        .admin-status.active {
            display: flex;
        }
        .admin-status i {
            margin-right: 5px;
            color: #4caf50;
        }
        /* Hero Section */
        .hero {
            height: 100vh;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80') no-repeat center center/cover;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding-top: 80px;
            position: relative;
        }
        .hero-content {
            max-width: 800px;
            position: relative;
            z-index: 2;
        }
        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            animation: fadeInUp 1s ease;
        }
        .hero p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            animation: fadeInUp 1s ease 0.2s;
            animation-fill-mode: both;
        }
        .love-timer {
            background-color: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            animation: fadeInUp 1s ease 0.4s;
            animation-fill-mode: both;
        }
        .love-timer h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        .timer {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        .timer-item {
            text-align: center;
        }
        .timer-value {
            font-size: 2.5rem;
            font-weight: 700;
        }
        .timer-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 20px;
        }
        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }
        /* Admin Edit Background Button */
        .edit-hero-bg {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background-color: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid white;
            color: white;
            padding: 10px 15px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            z-index: 10;
            display: none;
        }
        .edit-hero-bg.active {
            display: block;
        }
        .edit-hero-bg:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        /* Section */
        section {
            padding: 80px 0;
        }
        .section-title {
            text-align: center;
            margin-bottom: 60px;
        }
        .section-title h2 {
            font-size: 2.5rem;
            color: var(--dark-color);
            position: relative;
            display: inline-block;
            padding-bottom: 15px;
        }
        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--primary-color);
            border-radius: 2px;
        }
        /* Timeline */
        .timeline {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: var(--primary-color);
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
            border-radius: 3px;
        }
        .timeline-item {
            padding: 10px 40px;
            position: relative;
            width: 50%;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }
        .timeline-item.show {
            opacity: 1;
            transform: translateY(0);
        }
        .timeline-item::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            background-color: white;
            border: 4px solid var(--primary-color);
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::after {
            right: -17px;
        }
        .right::after {
            left: -17px;
        }
        .timeline-content {
            padding: 20px 30px;
            background-color: white;
            border-radius: 15px;
            box-shadow: var(--box-shadow);
            position: relative;
        }
        .timeline-content h3 {
            margin-top: 0;
            color: var(--primary-color);
        }
        .timeline-content p {
            margin-bottom: 0;
        }
        .timeline-date {
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        .timeline-image {
            width: 100%;
            border-radius: 10px;
            margin: 15px 0;
        }
        /* Gallery */
        .gallery-filters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 40px;
        }
        .filter-btn {
            background-color: white;
            border: 1px solid #ddd;
            padding: 8px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }
        .filter-btn.active,
        .filter-btn:hover {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }
        .gallery-item {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            position: relative;
            background-color: white;
        }
        .gallery-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        .gallery-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: var(--transition);
        }
        .gallery-item:hover .gallery-img {
            transform: scale(1.05);
        }
        .gallery-info {
            padding: 15px;
        }
        .gallery-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        .gallery-date {
            font-size: 0.9rem;
            color: #777;
        }
        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: var(--transition);
        }
        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }
        .view-btn {
            background-color: white;
            color: var(--primary-color);
            padding: 10px 20px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            transform: translateY(20px);
            transition: var(--transition);
        }
        .gallery-item:hover .view-btn {
            transform: translateY(0);
        }
        /* Stories */
        .stories-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .story-card {
            background-color: white;
            border-radius: 15px;
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
            transition: var(--transition);
        }
        .story-card:hover {
            transform: translateY(-5px);
        }
        .story-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .story-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }
        .story-meta h3 {
            margin: 0;
            font-size: 1.2rem;
        }
        .story-date {
            color: #777;
            font-size: 0.9rem;
        }
        .story-content {
            margin-bottom: 20px;
            line-height: 1.8;
        }
        .story-image {
            width: 100%;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        /* Special Moments */
        .moments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }
        .moment-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .moment-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(255, 107, 107, 0.3);
        }
        .moment-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .moment-content {
            padding: 25px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .moment-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        .moment-date {
            margin-bottom: 15px;
            opacity: 0.9;
        }
        .moment-category {
            display: inline-block;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 15px;
        }
        .moment-description {
            margin-bottom: 20px;
            opacity: 0.9;
            flex-grow: 1;
        }
        .moment-link {
            color: white;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }
        .moment-link:hover {
            transform: translateX(5px);
        }
        .moment-link i {
            margin-left: 5px;
        }
        /* Login Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 450px;
            padding: 40px;
            position: relative;
            animation: modalFadeIn 0.5s ease;
        }
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
            transition: var(--transition);
        }
        .close-modal:hover {
            color: var(--primary-color);
        }
        .login-form h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark-color);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            transition: var(--transition);
        }
        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2);
        }
        .login-btn-submit {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }
        .login-btn-submit:hover {
            background-color: var(--secondary-color);
        }
        /* Admin Panel */
        .admin-panel {
            display: none;
            background-color: white;
            border-radius: 15px;
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
        }
        .admin-panel.active {
            display: block;
        }
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .admin-title {
            font-size: 1.8rem;
            color: var(--dark-color);
        }
        .logout-btn-panel {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }
        .logout-btn-panel:hover {
            background-color: #d32f2f;
        }
        .admin-section {
            margin-bottom: 40px;
        }
        .admin-section h3 {
            margin-bottom: 20px;
            color: var(--dark-color);
        }
        .admin-form {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        .form-row .form-group {
            flex: 1;
        }
        .admin-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            margin-right: 10px;
        }
        .admin-btn:hover {
            background-color: var(--secondary-color);
        }
        .admin-btn.secondary {
            background-color: #6c757d;
        }
        .admin-btn.secondary:hover {
            background-color: #5a6268;
        }
        /* File Upload */
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        .file-upload-label {
            display: block;
            padding: 12px 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            color: #777;
        }
        .file-upload-label:hover {
            background-color: #f1f1f1;
        }
        .file-upload-label i {
            margin-right: 8px;
        }
        .file-preview {
            margin-top: 15px;
            text-align: center;
        }
        .file-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            box-shadow: var(--box-shadow);
        }
        /* Image Quality Control */
        .quality-control {
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .quality-control label {
            font-size: 0.9rem;
            color: #666;
        }
        .quality-slider {
            flex: 1;
            height: 5px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        .quality-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }
        .quality-value {
            font-size: 0.9rem;
            color: var(--primary-color);
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }
        /* Timer Edit - Admin Only */
        .timer-edit {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }
        .timer-edit.active {
            display: block;
        }
        .timer-edit-form {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .timer-edit-form input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        .timer-edit-form input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        .timer-edit-btn {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid white;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        .timer-edit-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        /* Gallery Detail Modal */
        .gallery-detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            overflow-y: auto;
        }
        .gallery-detail-modal.active {
            display: block;
        }
        .gallery-detail-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .gallery-detail-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .gallery-detail-title {
            font-size: 1.5rem;
            color: var(--dark-color);
        }
        .gallery-detail-close {
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
            transition: var(--transition);
        }
        .gallery-detail-close:hover {
            color: var(--primary-color);
        }
        .gallery-detail-body {
            padding: 20px;
        }
        .gallery-detail-info {
            margin-bottom: 20px;
        }
        .gallery-detail-date {
            color: #777;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        .gallery-detail-description {
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .gallery-detail-photos {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        .gallery-detail-photo {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }
        .gallery-detail-photo:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        .gallery-detail-photo img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: var(--transition);
        }
        .gallery-detail-photo:hover img {
            transform: scale(1.05);
        }
        .gallery-detail-photo .download-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            opacity: 0;
            transition: var(--transition);
            z-index: 2;
        }
        .gallery-detail-photo:hover .download-btn {
            opacity: 1;
        }
        .gallery-detail-photo .download-btn:hover {
            background-color: var(--primary-color);
        }
        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 4000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .lightbox.active {
            display: flex;
        }
        .lightbox-content {
            position: relative;
            max-width: 95%;
            max-height: 95%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .lightbox-img-container {
            position: relative;
            max-width: 100%;
            max-height: 85vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .lightbox-img {
            max-width: 100%;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 5px;
        }
        .lightbox-controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
        }
        .lightbox-nav {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid white;
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.2rem;
        }
        .lightbox-nav:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        .lightbox-download {
            background-color: var(--primary-color);
            border: none;
            color: white;
            border-radius: 30px;
            padding: 10px 20px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .lightbox-download:hover {
            background-color: var(--secondary-color);
        }
        .lightbox-close {
            position: absolute;
            top: -50px;
            right: 0;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: var(--transition);
        }
        .lightbox-close:hover {
            color: var(--primary-color);
        }
        .lightbox-caption {
            color: white;
            text-align: center;
            margin-top: 15px;
            font-size: 1.1rem;
        }
        /* Hero Background Edit Modal */
        .hero-bg-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2500;
            justify-content: center;
            align-items: center;
        }
        .hero-bg-modal.active {
            display: flex;
        }
        .hero-bg-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            animation: modalFadeIn 0.5s ease;
        }
        .hero-bg-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .hero-bg-title {
            font-size: 1.5rem;
            color: var(--dark-color);
        }
        .hero-bg-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .hero-bg-option {
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
            height: 150px;
            position: relative;
        }
        .hero-bg-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
        }
        .hero-bg-option.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2);
        }
        .hero-bg-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .hero-bg-option-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px;
            text-align: center;
            font-size: 0.9rem;
        }
        .hero-bg-custom {
            margin-top: 15px;
        }
        .hero-bg-upload {
            margin-top: 15px;
        }
        .hero-bg-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        /* Footer */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 60px 0 30px;
        }
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        .footer-column h3 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }
        .footer-column h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: var(--primary-color);
        }
        .footer-column p {
            margin-bottom: 15px;
            opacity: 0.8;
        }
        .footer-links {
            list-style: none;
        }
        .footer-links li {
            margin-bottom: 10px;
        }
        .footer-links a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: var(--transition);
        }
        .footer-links a:hover {
            opacity: 1;
            padding-left: 5px;
        }
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .social-links a {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            transition: var(--transition);
        }
        .social-links a:hover {
            background-color: var(--primary-color);
            transform: translateY(-3px);
        }
        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.7;
        }
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }
        .fade-in.show {
            opacity: 1;
            transform: translateY(0);
        }
        /* Responsive */
        @media (max-width: 992px) {
            .timeline::after {
                left: 31px;
            }
            .timeline-item {
                width: 100%;
                padding-left: 70px;
                padding-right: 25px;
            }
            .timeline-item::before {
                left: 60px;
                border: medium solid white;
                border-width: 10px 10px 10px 0;
                border-color: transparent white transparent transparent;
            }
            .left::after,
            .right::after {
                left: 21px;
            }
            .right {
                left: 0%;
            }
        }
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            .nav-links {
                display: none;
            }
            .timer {
                flex-wrap: wrap;
                gap: 10px;
            }
            .timer-item {
                flex: 1;
                min-width: 80px;
            }
            .timer-value {
                font-size: 1.8rem;
            }
            .form-row {
                flex-direction: column;
            }
            .gallery-detail-photos {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            .lightbox-img {
                max-height: 70vh;
            }
            .hero-bg-options {
                grid-template-columns: 1fr;
            }
        }
        @media (max-width: 576px) {
            .hero h1 {
                font-size: 2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .section-title h2 {
                font-size: 2rem;
            }
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 15px;
            }
            .moments-grid {
                grid-template-columns: 1fr;
            }
            .gallery-detail-photos {
                grid-template-columns: 1fr;
            }
            .lightbox-controls {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }
            .lightbox-img {
                max-height: 60vh;
            }
        }
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--dark-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: var(--box-shadow);
            z-index: 5000;
            transform: translateY(100px);
            opacity: 0;
            transition: var(--transition);
        }
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        .toast.success {
            background-color: #4caf50;
        }
        .toast.error {
            background-color: #f44336;
        }
        /* Admin Action Buttons */
        .admin-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            z-index: 10;
        }
        .admin-actions button {
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        .admin-actions button:hover {
            background-color: white;
            transform: scale(1.1);
        }
        .admin-actions button.edit:hover {
            color: var(--primary-color);
        }
        .admin-actions button.delete:hover {
            color: #f44336;
        }
        .timeline-content {
            position: relative;
        }
        .story-card {
            position: relative;
        }
        .moment-card {
            position: relative;
        }
        .gallery-item {
            position: relative;
        }
        /* Admin Edit Timer Button - Only visible to admin */
        .edit-timer-btn {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid white;
            color: white;
            padding: 8px 15px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            margin-top: 15px;
            display: none;
        }
        .edit-timer-btn.active {
            display: inline-block;
        }
        .edit-timer-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        /* Firebase Connection Status */
        .firebase-status {
            position: fixed;
            bottom: 10px;
            left: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .firebase-status.connected {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        .firebase-status.disconnected {
            background-color: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
    </style>
</head>
<body>
    <!-- Firebase Connection Status -->
    <div class="firebase-status disconnected" id="firebaseStatus">
        <i class="fas fa-wifi"></i>
        <span>Connecting to Firebase...</span>
    </div>

    <!-- Preloader -->
    <div class="preloader">
        <div class="heart"></div>
    </div>
    
    <!-- Header -->
    <header>
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <i class="fas fa-heart"></i>
                    <span>Kenangan Kita</span>
                </div>
                <ul class="nav-links">
                    <li><a href="#home">Beranda</a></li>
                    <li><a href="#timeline">Timeline</a></li>
                    <li><a href="#gallery">Galeri</a></li>
                    <li><a href="#stories">Cerita Kita</a></li>
                    <li><a href="#moments">Momen Spesial</a></li>
                </ul>
                <div class="admin-status" id="adminStatus">
                    <i class="fas fa-user-shield"></i>
                    <span>Admin Mode</span>
                </div>
                <button class="login-btn" id="loginBtn">Admin Login</button>
                <button class="logout-btn" id="logoutBtn">Logout</button>
            </div>
        </div>
    </header>
    
    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Kenangan Indah Bersamamu</h1>
            <p>Setiap momen bersamamu adalah anugerah terindah dalam hidupku</p>
            
            <div class="love-timer">
                <h3>Waktu Kita Bersama</h3>
                <div class="timer">
                    <div class="timer-item">
                        <div class="timer-value" id="days">0</div>
                        <div class="timer-label">Hari</div>
                    </div>
                    <div class="timer-item">
                        <div class="timer-value" id="hours">0</div>
                        <div class="timer-label">Jam</div>
                    </div>
                    <div class="timer-item">
                        <div class="timer-value" id="minutes">0</div>
                        <div class="timer-label">Menit</div>
                    </div>
                    <div class="timer-item">
                        <div class="timer-value" id="seconds">0</div>
                        <div class="timer-label">Detik</div>
                    </div>
                </div>
                
                <div class="timer-edit" id="timerEdit">
                    <div class="timer-edit-form">
                        <input type="date" id="startDateInput" placeholder="Tanggal mulai">
                        <button class="timer-edit-btn" id="updateTimerBtn">Update</button>
                        <button class="timer-edit-btn" id="cancelTimerBtn">Batal</button>
                    </div>
                </div>
                
                <button class="edit-timer-btn" id="editTimerBtn">
                    <i class="fas fa-edit"></i> Edit Tanggal
                </button>
            </div>
            
            <a href="#timeline" class="btn">Jelajahi Kenangan</a>
        </div>
        
        <!-- Admin Edit Background Button -->
        <button class="edit-hero-bg" id="editHeroBgBtn">
            <i class="fas fa-image"></i> Edit Background
        </button>
    </section>
    
    <!-- Timeline Section -->
    <section class="timeline-section" id="timeline">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Timeline Kisah Kita</h2>
            </div>
            
            <div class="admin-panel" id="timelineAdminPanel">
                <div class="admin-header">
                    <h2 class="admin-title">Admin Panel - Timeline</h2>
                    <button class="logout-btn-panel" id="logoutTimelineBtn">Logout</button>
                </div>
                
                <div class="admin-section">
                    <h3>Tambah Timeline Baru</h3>
                    <div class="admin-form">
                        <div class="form-group">
                            <label for="timelineTitle">Judul</label>
                            <input type="text" class="form-control" id="timelineTitle" placeholder="Masukkan judul timeline">
                        </div>
                        <div class="form-group">
                            <label for="timelineDate">Tanggal</label>
                            <input type="date" class="form-control" id="timelineDate">
                        </div>
                        <div class="form-group">
                            <label for="timelineImage">Gambar</label>
                            <div class="file-upload">
                                <input type="file" id="timelineImage" accept="image/*">
                                <label for="timelineImage" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i> Pilih Gambar
                                </label>
                            </div>
                            <div class="quality-control">
                                <label for="timelineQuality">Kualitas:</label>
                                <input type="range" id="timelineQuality" class="quality-slider" min="10" max="100" value="70">
                                <span class="quality-value" id="timelineQualityValue">70%</span>
                            </div>
                            <div class="file-preview" id="timelineImagePreview"></div>
                        </div>
                        <div class="form-group">
                            <label for="timelineDescription">Deskripsi</label>
                            <textarea class="form-control" id="timelineDescription" rows="3" placeholder="Masukkan deskripsi timeline"></textarea>
                        </div>
                        <button class="admin-btn" id="addTimelineBtn">Tambah Timeline</button>
                        <button class="admin-btn secondary" id="cancelTimelineBtn">Batal</button>
                    </div>
                </div>
            </div>
            
            <div class="timeline" id="timelineContainer">
                <!-- Timeline items will be dynamically added here -->
            </div>
        </div>
    </section>
    
    <!-- Gallery Section -->
    <section class="gallery-section" id="gallery">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Galeri Kenangan</h2>
            </div>
            
            <div class="admin-panel" id="galleryAdminPanel">
                <div class="admin-header">
                    <h2 class="admin-title">Admin Panel - Galeri</h2>
                    <button class="logout-btn-panel" id="logoutGalleryBtn">Logout</button>
                </div>
                
                <div class="admin-section">
                    <h3>Tambah Album Baru</h3>
                    <div class="admin-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="albumName">Nama Album</label>
                                <input type="text" class="form-control" id="albumName" placeholder="Masukkan nama album">
                            </div>
                            <div class="form-group">
                                <label for="albumDate">Tanggal</label>
                                <input type="date" class="form-control" id="albumDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="albumCategory">Kategori</label>
                            <select class="form-control" id="albumCategory">
                                <option value="perjalanan">Perjalanan</option>
                                <option value="moment">Momen Spesial</option>
                                <option value="daily">Keseharian</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="albumDescription">Deskripsi</label>
                            <textarea class="form-control" id="albumDescription" rows="2" placeholder="Masukkan deskripsi album"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Foto Album</label>
                            <div class="file-upload">
                                <input type="file" id="albumPhotos" accept="image/*" multiple>
                                <label for="albumPhotos" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i> Pilih Foto (bisa banyak)
                                </label>
                            </div>
                            <div class="quality-control">
                                <label for="albumQuality">Kualitas:</label>
                                <input type="range" id="albumQuality" class="quality-slider" min="10" max="100" value="70">
                                <span class="quality-value" id="albumQualityValue">70%</span>
                            </div>
                            <div class="file-preview" id="albumPhotosPreview"></div>
                        </div>
                        <button class="admin-btn" id="addAlbumBtn">Tambah Album</button>
                        <button class="admin-btn secondary" id="cancelAlbumBtn">Batal</button>
                    </div>
                </div>
            </div>
            
            <div class="gallery-filters fade-in">
                <button class="filter-btn active" data-filter="all">Semua</button>
                <button class="filter-btn" data-filter="perjalanan">Perjalanan</button>
                <button class="filter-btn" data-filter="moment">Momen Spesial</button>
                <button class="filter-btn" data-filter="daily">Keseharian</button>
            </div>
            
            <div class="gallery-grid" id="galleryContainer">
                <!-- Gallery items will be dynamically added here -->
            </div>
        </div>
    </section>
    
    <!-- Stories Section -->
    <section class="stories-section" id="stories">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Cerita Kita</h2>
            </div>
            
            <div class="admin-panel" id="storiesAdminPanel">
                <div class="admin-header">
                    <h2 class="admin-title">Admin Panel - Cerita</h2>
                    <button class="logout-btn-panel" id="logoutStoriesBtn">Logout</button>
                </div>
                
                <div class="admin-section">
                    <h3>Tambah Cerita Baru</h3>
                    <div class="admin-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="storyTitle">Judul Cerita</label>
                                <input type="text" class="form-control" id="storyTitle" placeholder="Masukkan judul cerita">
                            </div>
                            <div class="form-group">
                                <label for="storyDate">Tanggal</label>
                                <input type="date" class="form-control" id="storyDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="storyImage">Gambar</label>
                            <div class="file-upload">
                                <input type="file" id="storyImage" accept="image/*">
                                <label for="storyImage" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i> Pilih Gambar
                                </label>
                            </div>
                            <div class="quality-control">
                                <label for="storyQuality">Kualitas:</label>
                                <input type="range" id="storyQuality" class="quality-slider" min="10" max="100" value="70">
                                <span class="quality-value" id="storyQualityValue">70%</span>
                            </div>
                            <div class="file-preview" id="storyImagePreview"></div>
                        </div>
                        <div class="form-group">
                            <label for="storyContent">Isi Cerita</label>
                            <textarea class="form-control" id="storyContent" rows="5" placeholder="Tulis cerita di sini..."></textarea>
                        </div>
                        <button class="admin-btn" id="addStoryBtn">Tambah Cerita</button>
                        <button class="admin-btn secondary" id="cancelStoryBtn">Batal</button>
                    </div>
                </div>
            </div>
            
            <div class="stories-container" id="storiesContainer">
                <!-- Story cards will be dynamically added here -->
            </div>
        </div>
    </section>
    
    <!-- Special Moments Section -->
    <section class="moments-section" id="moments">
        <div class="container">
            <div class="section-title fade-in">
                <h2>Momen Spesial</h2>
            </div>
            
            <div class="admin-panel" id="momentsAdminPanel">
                <div class="admin-header">
                    <h2 class="admin-title">Admin Panel - Momen Spesial</h2>
                    <button class="logout-btn-panel" id="logoutMomentsBtn">Logout</button>
                </div>
                
                <div class="admin-section">
                    <h3>Tambah Momen Spesial Baru</h3>
                    <div class="admin-form">
                        <div class="form-group">
                            <label for="momentTitle">Judul Momen</label>
                            <input type="text" class="form-control" id="momentTitle" placeholder="Masukkan judul momen spesial">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="momentDate">Tanggal</label>
                                <input type="date" class="form-control" id="momentDate">
                            </div>
                            <div class="form-group">
                                <label for="momentCategory">Kategori</label>
                                <input type="text" class="form-control" id="momentCategory" placeholder="Ketik kategori (cont: Anniversary, Ulang Tahun, Liburan, dll)">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="momentImage">Gambar</label>
                            <div class="file-upload">
                                <input type="file" id="momentImage" accept="image/*">
                                <label for="momentImage" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i> Pilih Gambar
                                </label>
                            </div>
                            <div class="quality-control">
                                <label for="momentQuality">Kualitas:</label>
                                <input type="range" id="momentQuality" class="quality-slider" min="10" max="100" value="70">
                                <span class="quality-value" id="momentQualityValue">70%</span>
                            </div>
                            <div class="file-preview" id="momentImagePreview"></div>
                        </div>
                        <div class="form-group">
                            <label for="momentDescription">Deskripsi</label>
                            <textarea class="form-control" id="momentDescription" rows="3" placeholder="Masukkan deskripsi momen spesial"></textarea>
                        </div>
                        <button class="admin-btn" id="addMomentBtn">Tambah Momen</button>
                        <button class="admin-btn secondary" id="cancelMomentBtn">Batal</button>
                    </div>
                </div>
            </div>
            
            <div class="moments-grid" id="momentsContainer">
                <!-- Moment cards will be dynamically added here -->
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Tentang Kenangan Kita</h3>
                    <p>Website ini dibuat khusus untuk mengabadikan semua kenangan indah yang kita lalui bersama.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Menu Cepat</h3>
                    <ul class="footer-links">
                        <li><a href="#home">Beranda</a></li>
                        <li><a href="#timeline">Timeline</a></li>
                        <li><a href="#gallery">Galeri</a></li>
                        <li><a href="#stories">Cerita Kita</a></li>
                        <li><a href="#moments">Momen Spesial</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Hubungi Kami</h3>
                    <p><i class="fas fa-envelope"></i> kenangan@kita.com</p>
                    <p><i class="fas fa-phone"></i> +62 812 3456 7890</p>
                    <p><i class="fas fa-map-marker-alt"></i> Jakarta, Indonesia</p>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Kenangan Kita. Dibuat dengan <i class="fas fa-heart" style="color: var(--primary-color);"></i> untuk kenangan terindah.</p>
            </div>
        </div>
    </footer>
    
    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <span class="close-modal" id="closeLoginModal">&times;</span>
            <div class="login-form">
                <h2>Admin Login</h2>
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" class="form-control" id="username" placeholder="Masukkan username">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" class="form-control" id="password" placeholder="Masukkan password">
                </div>
                <button class="login-btn-submit" id="loginSubmitBtn">Login</button>
            </div>
        </div>
    </div>
    
    <!-- Hero Background Edit Modal -->
    <div class="hero-bg-modal" id="heroBgModal">
        <div class="hero-bg-content">
            <div class="hero-bg-header">
                <h2 class="hero-bg-title">Edit Background Halaman</h2>
                <span class="close-modal" id="closeHeroBgModal">&times;</span>
            </div>
            
            <div class="hero-bg-options">
                <div class="hero-bg-option active" data-bg="https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80">
                    <img src="https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Default Background">
                    <div class="hero-bg-option-label">Default</div>
                </div>
                <div class="hero-bg-option" data-bg="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80">
                    <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Sunset Beach">
                    <div class="hero-bg-option-label">Pantai Sunset</div>
                </div>
                <div class="hero-bg-option" data-bg="https://images.unsplash.com/photo-1570077188670-e3a8d69ac5ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80">
                    <img src="https://images.unsplash.com/photo-1570077188670-e3a8d69ac5ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Mountain">
                    <div class="hero-bg-option-label">Gunung</div>
                </div>
                <div class="hero-bg-option" data-bg="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80">
                    <img src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Flowers">
                    <div class="hero-bg-option-label">Bunga</div>
                </div>
            </div>
            
            <div class="hero-bg-custom">
                <div class="form-group">
                    <label for="customBgUrl">URL Background Custom</label>
                    <input type="text" class="form-control" id="customBgUrl" placeholder="https://example.com/image.jpg">
                </div>
            </div>
            
            <div class="hero-bg-upload">
                <div class="form-group">
                    <label>Upload Background</label>
                    <div class="file-upload">
                        <input type="file" id="heroBgUpload" accept="image/*">
                        <label for="heroBgUpload" class="file-upload-label">
                            <i class="fas fa-cloud-upload-alt"></i> Pilih Gambar
                        </label>
                    </div>
                    <div class="quality-control">
                        <label for="heroBgQuality">Kualitas:</label>
                        <input type="range" id="heroBgQuality" class="quality-slider" min="10" max="100" value="70">
                        <span class="quality-value" id="heroBgQualityValue">70%</span>
                    </div>
                    <div class="file-preview" id="heroBgUploadPreview"></div>
                </div>
            </div>
            
            <div class="hero-bg-actions">
                <button class="admin-btn secondary" id="cancelHeroBgBtn">Batal</button>
                <button class="admin-btn" id="saveHeroBgBtn">Simpan</button>
            </div>
        </div>
    </div>
    
    <!-- Gallery Detail Modal -->
    <div class="gallery-detail-modal" id="galleryDetailModal">
        <div class="gallery-detail-content">
            <div class="gallery-detail-header">
                <h2 class="gallery-detail-title" id="galleryDetailTitle">Album Title</h2>
                <span class="gallery-detail-close" id="closeGalleryDetail">&times;</span>
            </div>
            <div class="gallery-detail-body">
                <div class="gallery-detail-info">
                    <p class="gallery-detail-date" id="galleryDetailDate">Date</p>
                    <p class="gallery-detail-description" id="galleryDetailDescription">Description</p>
                </div>
                <div class="gallery-detail-photos" id="galleryDetailPhotos">
                    <!-- Photos will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-content">
            <span class="lightbox-close" id="lightboxClose">&times;</span>
            <div class="lightbox-img-container">
                <img src="" alt="" class="lightbox-img" id="lightboxImg">
            </div>
            <div class="lightbox-controls">
                <button class="lightbox-nav" id="lightboxPrev">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="lightbox-download" id="lightboxDownload">
                    <i class="fas fa-download"></i> Download
                </button>
                <button class="lightbox-nav" id="lightboxNext">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="lightbox-caption" id="lightboxCaption"></div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Firebase - GANTI dengan konfigurasi Firebase Anda
            // Baca konfigurasi dari file firebase.config yang sudah ada
            let firebaseConfig = {};
            
            // Coba ambil konfigurasi dari file firebase.config
            fetch('firebase.config')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to load Firebase config');
                    }
                    return response.json();
                })
                .then(config => {
                    firebaseConfig = config;
                    initializeFirebase();
                })
                .catch(error => {
                    console.error('Error loading Firebase config:', error);
                    // Fallback ke konfigurasi default jika file tidak ditemukan
                    firebaseConfig = {
                        apiKey: "AIzaSyB example",
                        authDomain: "kenangan-kita-example.firebaseapp.com",
                        databaseURL: "https://kenangan-kita-example-default-rtdb.firebaseio.com",
                        projectId: "kenangan-kita-example",
                        storageBucket: "kenangan-kita-example.appspot.com",
                        messagingSenderId: "123456789",
                        appId: "1:123456789:web:abcdef123456"
                    };
                    initializeFirebase();
                });
            
            function initializeFirebase() {
                // Initialize Firebase
                let database;
                let storage;
                let firebaseInitialized = false;
                
                try {
                    firebase.initializeApp(firebaseConfig);
                    database = firebase.database();
                    storage = firebase.storage();
                    firebaseInitialized = true;
                    console.log("Firebase initialized successfully");
                    
                    // Update connection status
                    const firebaseStatus = document.getElementById('firebaseStatus');
                    if (firebaseStatus) {
                        firebaseStatus.className = 'firebase-status connected';
                        firebaseStatus.innerHTML = '<i class="fas fa-check-circle"></i><span>Connected to Firebase</span>';
                    }
                } catch (error) {
                    console.error("Error initializing Firebase:", error);
                    firebaseInitialized = false;
                    
                    // Update connection status
                    const firebaseStatus = document.getElementById('firebaseStatus');
                    if (firebaseStatus) {
                        firebaseStatus.className = 'firebase-status disconnected';
                        firebaseStatus.innerHTML = '<i class="fas fa-exclamation-circle"></i><span>Failed to connect to Firebase</span>';
                    }
                }
                
                // Preloader - Sembunyikan preloader setelah halaman dimuat
                window.addEventListener('load', function() {
                    setTimeout(function() {
                        const preloader = document.querySelector('.preloader');
                        if (preloader) {
                            preloader.classList.add('hidden');
                        }
                    }, 1000);
                });
                
                // Fallback untuk menyembunyikan preloader jika ada error
                setTimeout(function() {
                    const preloader = document.querySelector('.preloader');
                    if (preloader && !preloader.classList.contains('hidden')) {
                        preloader.classList.add('hidden');
                        console.log("Preloader hidden by fallback");
                    }
                }, 3000);
                
                // Love Timer
                let startDate = new Date(localStorage.getItem('loveStartDate') || '2023-01-01');
                const timerElements = {
                    days: document.getElementById('days'),
                    hours: document.getElementById('hours'),
                    minutes: document.getElementById('minutes'),
                    seconds: document.getElementById('seconds')
                };
                
                function updateTimer() {
                    const now = new Date();
                    const diff = now - startDate;
                    
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    if (timerElements.days) timerElements.days.textContent = days;
                    if (timerElements.hours) timerElements.hours.textContent = hours;
                    if (timerElements.minutes) timerElements.minutes.textContent = minutes;
                    if (timerElements.seconds) timerElements.seconds.textContent = seconds;
                }
                
                setInterval(updateTimer, 1000);
                updateTimer();
                
                // Timer Edit - Admin Only
                const editTimerBtn = document.getElementById('editTimerBtn');
                const timerEdit = document.getElementById('timerEdit');
                const startDateInput = document.getElementById('startDateInput');
                const updateTimerBtn = document.getElementById('updateTimerBtn');
                const cancelTimerBtn = document.getElementById('cancelTimerBtn');
                
                if (editTimerBtn) {
                    editTimerBtn.addEventListener('click', function() {
                        if (timerEdit) timerEdit.classList.add('active');
                        if (startDateInput) startDateInput.value = startDate.toISOString().split('T')[0];
                    });
                }
                
                if (updateTimerBtn) {
                    updateTimerBtn.addEventListener('click', function() {
                        const newDate = startDateInput ? startDateInput.value : null;
                        if (newDate) {
                            startDate = new Date(newDate);
                            localStorage.setItem('loveStartDate', newDate);
                            
                            // Simpan ke Firebase jika sudah diinisialisasi
                            if (firebaseInitialized && database) {
                                database.ref('settings/loveStartDate').set(newDate);
                            }
                            
                            updateTimer();
                            if (timerEdit) timerEdit.classList.remove('active');
                            showToast('Tanggal berhasil diperbarui.', 'success');
                        } else {
                            showToast('Harap pilih tanggal!', 'error');
                        }
                    });
                }
                
                if (cancelTimerBtn) {
                    cancelTimerBtn.addEventListener('click', function() {
                        if (timerEdit) timerEdit.classList.remove('active');
                    });
                }
                
                // Smooth Scrolling
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        const target = document.querySelector(this.getAttribute('href'));
                        if (target) {
                            window.scrollTo({
                                top: target.offsetTop - 80,
                                behavior: 'smooth'
                            });
                        }
                    });
                });
                
                // Login Modal
                const loginBtn = document.getElementById('loginBtn');
                const logoutBtn = document.getElementById('logoutBtn');
                const adminStatus = document.getElementById('adminStatus');
                const loginModal = document.getElementById('loginModal');
                const closeLoginModal = document.getElementById('closeLoginModal');
                const loginSubmitBtn = document.getElementById('loginSubmitBtn');
                const usernameInput = document.getElementById('username');
                const passwordInput = document.getElementById('password');
                
                if (loginBtn) {
                    loginBtn.addEventListener('click', function() {
                        if (loginModal) loginModal.classList.add('active');
                    });
                }
                
                if (closeLoginModal) {
                    closeLoginModal.addEventListener('click', function() {
                        if (loginModal) loginModal.classList.remove('active');
                        if (usernameInput) usernameInput.value = '';
                        if (passwordInput) passwordInput.value = '';
                    });
                }
                
                window.addEventListener('click', function(e) {
                    if (e.target === loginModal) {
                        if (loginModal) loginModal.classList.remove('active');
                        if (usernameInput) usernameInput.value = '';
                        if (passwordInput) passwordInput.value = '';
                    }
                });
                
                // Admin Login
                if (loginSubmitBtn) {
                    loginSubmitBtn.addEventListener('click', function() {
                        const username = usernameInput ? usernameInput.value.trim() : '';
                        const password = passwordInput ? passwordInput.value.trim() : '';
                        
                        if (!username || !password) {
                            showToast('Username dan password harus diisi!', 'error');
                            return;
                        }
                        
                        // Simple authentication
                        if (username === 'admin' && password === 'love123') {
                            showToast('Login berhasil! Selamat datang admin.', 'success');
                            if (loginModal) loginModal.classList.remove('active');
                            if (usernameInput) usernameInput.value = '';
                            if (passwordInput) passwordInput.value = '';
                            
                            // Show admin panels and edit buttons
                            document.querySelectorAll('.admin-panel').forEach(panel => {
                                panel.classList.add('active');
                            });
                            const editHeroBgBtn = document.getElementById('editHeroBgBtn');
                            if (editHeroBgBtn) editHeroBgBtn.classList.add('active');
                            
                            // Show admin status and hide login button
                            if (adminStatus) adminStatus.classList.add('active');
                            if (loginBtn) loginBtn.classList.remove('active');
                            if (logoutBtn) logoutBtn.classList.add('active');
                            
                            // Show edit timer button for admin
                            if (editTimerBtn) editTimerBtn.classList.add('active');
                        } else {
                            showToast('Username atau password salah!', 'error');
                        }
                    });
                }
                
                // Logout button in header
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', function() {
                        // Hide admin panels and edit buttons
                        document.querySelectorAll('.admin-panel').forEach(panel => {
                            panel.classList.remove('active');
                        });
                        const editHeroBgBtn = document.getElementById('editHeroBgBtn');
                        if (editHeroBgBtn) editHeroBgBtn.classList.remove('active');
                        
                        // Hide admin status and show login button
                        if (adminStatus) adminStatus.classList.remove('active');
                        if (logoutBtn) logoutBtn.classList.remove('active');
                        if (loginBtn) loginBtn.classList.add('active');
                        
                        // Hide edit timer button
                        if (editTimerBtn) editTimerBtn.classList.remove('active');
                        
                        showToast('Anda telah logout.', 'success');
                    });
                }
                
                // Logout buttons in admin panels
                const logoutTimelineBtn = document.getElementById('logoutTimelineBtn');
                if (logoutTimelineBtn) {
                    logoutTimelineBtn.addEventListener('click', function() {
                        const timelineAdminPanel = document.getElementById('timelineAdminPanel');
                        if (timelineAdminPanel) timelineAdminPanel.classList.remove('active');
                        if (adminStatus) adminStatus.classList.remove('active');
                        if (logoutBtn) logoutBtn.classList.remove('active');
                        if (loginBtn) loginBtn.classList.add('active');
                        if (editTimerBtn) editTimerBtn.classList.remove('active');
                        showToast('Anda telah logout.', 'success');
                    });
                }
                
                const logoutGalleryBtn = document.getElementById('logoutGalleryBtn');
                if (logoutGalleryBtn) {
                    logoutGalleryBtn.addEventListener('click', function() {
                        const galleryAdminPanel = document.getElementById('galleryAdminPanel');
                        if (galleryAdminPanel) galleryAdminPanel.classList.remove('active');
                        if (adminStatus) adminStatus.classList.remove('active');
                        if (logoutBtn) logoutBtn.classList.remove('active');
                        if (loginBtn) loginBtn.classList.add('active');
                        if (editTimerBtn) editTimerBtn.classList.remove('active');
                        showToast('Anda telah logout.', 'success');
                    });
                }
                
                const logoutStoriesBtn = document.getElementById('logoutStoriesBtn');
                if (logoutStoriesBtn) {
                    logoutStoriesBtn.addEventListener('click', function() {
                        const storiesAdminPanel = document.getElementById('storiesAdminPanel');
                        if (storiesAdminPanel) storiesAdminPanel.classList.remove('active');
                        if (adminStatus) adminStatus.classList.remove('active');
                        if (logoutBtn) logoutBtn.classList.remove('active');
                        if (loginBtn) loginBtn.classList.add('active');
                        if (editTimerBtn) editTimerBtn.classList.remove('active');
                        showToast('Anda telah logout.', 'success');
                    });
                }
                
                const logoutMomentsBtn = document.getElementById('logoutMomentsBtn');
                if (logoutMomentsBtn) {
                    logoutMomentsBtn.addEventListener('click', function() {
                        const momentsAdminPanel = document.getElementById('momentsAdminPanel');
                        if (momentsAdminPanel) momentsAdminPanel.classList.remove('active');
                        if (adminStatus) adminStatus.classList.remove('active');
                        if (logoutBtn) logoutBtn.classList.remove('active');
                        if (loginBtn) loginBtn.classList.add('active');
                        if (editTimerBtn) editTimerBtn.classList.remove('active');
                        showToast('Anda telah logout.', 'success');
                    });
                }
                
                // Hero Background Edit
                const editHeroBgBtn = document.getElementById('editHeroBgBtn');
                const heroBgModal = document.getElementById('heroBgModal');
                const closeHeroBgModal = document.getElementById('closeHeroBgModal');
                const cancelHeroBgBtn = document.getElementById('cancelHeroBgBtn');
                const saveHeroBgBtn = document.getElementById('saveHeroBgBtn');
                const customBgUrl = document.getElementById('customBgUrl');
                const heroBgUpload = document.getElementById('heroBgUpload');
                const heroBgUploadPreview = document.getElementById('heroBgUploadPreview');
                const heroBgOptions = document.querySelectorAll('.hero-bg-option');
                const heroSection = document.querySelector('.hero');
                
                if (editHeroBgBtn) {
                    editHeroBgBtn.addEventListener('click', function() {
                        if (heroBgModal) heroBgModal.classList.add('active');
                        
                        // Set current background as active
                        const currentBg = localStorage.getItem('heroBackground') || 
                                          'https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80';
                        
                        if (heroBgOptions) {
                            heroBgOptions.forEach(option => {
                                option.classList.remove('active');
                                if (option.getAttribute('data-bg') === currentBg) {
                                    option.classList.add('active');
                                }
                            });
                        }
                        
                        if (customBgUrl) customBgUrl.value = '';
                        if (heroBgUpload) heroBgUpload.value = '';
                        if (heroBgUploadPreview) heroBgUploadPreview.innerHTML = '';
                    });
                }
                
                if (closeHeroBgModal) {
                    closeHeroBgModal.addEventListener('click', function() {
                        if (heroBgModal) heroBgModal.classList.remove('active');
                    });
                }
                
                if (cancelHeroBgBtn) {
                    cancelHeroBgBtn.addEventListener('click', function() {
                        if (heroBgModal) heroBgModal.classList.remove('active');
                    });
                }
                
                window.addEventListener('click', function(e) {
                    if (e.target === heroBgModal) {
                        if (heroBgModal) heroBgModal.classList.remove('active');
                    }
                });
                
                // Hero background option selection
                if (heroBgOptions) {
                    heroBgOptions.forEach(option => {
                        option.addEventListener('click', function() {
                            heroBgOptions.forEach(opt => opt.classList.remove('active'));
                            this.classList.add('active');
                            if (customBgUrl) customBgUrl.value = '';
                            if (heroBgUpload) heroBgUpload.value = '';
                            if (heroBgUploadPreview) heroBgUploadPreview.innerHTML = '';
                        });
                    });
                }
                
                // Setup file upload for hero background
                setupFileUpload('heroBgUpload', 'heroBgUploadPreview', 'heroBgQuality');
                
                // Save hero background
                if (saveHeroBgBtn) {
                    saveHeroBgBtn.addEventListener('click', async function() {
                        let selectedBg = '';
                        
                        // Check if custom URL is provided
                        if (customBgUrl && customBgUrl.value.trim()) {
                            // Validate URL format
                            if (isValidUrl(customBgUrl.value.trim())) {
                                selectedBg = customBgUrl.value.trim();
                            } else {
                                showToast('URL tidak valid!', 'error');
                                return;
                            }
                        } else if (heroBgUpload && heroBgUpload.files && heroBgUpload.files[0]) {
                            // Get uploaded image
                            const qualitySlider = document.getElementById('heroBgQuality');
                            const quality = qualitySlider ? qualitySlider.value / 100 : 0.7;
                            const compressedImage = await compressImage(heroBgUpload.files[0], quality);
                            selectedBg = compressedImage;
                        } else {
                            // Get selected option
                            const activeOption = document.querySelector('.hero-bg-option.active');
                            if (activeOption) {
                                selectedBg = activeOption.getAttribute('data-bg');
                            } else {
                                showToast('Pilih background, masukkan URL, atau upload gambar!', 'error');
                                return;
                            }
                        }
                        
                        // Save to localStorage
                        localStorage.setItem('heroBackground', selectedBg);
                        
                        // Save to Firebase jika sudah diinisialisasi
                        if (firebaseInitialized && database) {
                            database.ref('settings/heroBackground').set(selectedBg);
                        }
                        
                        // Apply new background
                        if (heroSection) {
                            heroSection.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('${selectedBg}')`;
                        }
                        
                        if (heroBgModal) heroBgModal.classList.remove('active');
                        showToast('Background berhasil diperbarui.', 'success');
                    });
                }
                
                // URL validation function
                function isValidUrl(string) {
                    try {
                        new URL(string);
                        return true;
                    } catch (_) {
                        return false;
                    }
                }
                
                // Apply saved hero background
                const savedHeroBg = localStorage.getItem('heroBackground');
                if (savedHeroBg && heroSection) {
                    heroSection.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('${savedHeroBg}')`;
                }
                
                // Toast Notification
                function showToast(message, type = 'success') {
                    const toast = document.getElementById('toast');
                    if (toast) {
                        toast.textContent = message;
                        toast.className = 'toast show';
                        
                        if (type === 'error') {
                            toast.classList.add('error');
                        } else if (type === 'success') {
                            toast.classList.add('success');
                        }
                        
                        setTimeout(function() {
                            toast.classList.remove('show');
                        }, 3000);
                    }
                }
                
                // Setup quality sliders
                function setupQualitySlider(sliderId, valueId) {
                    const slider = document.getElementById(sliderId);
                    const valueDisplay = document.getElementById(valueId);
                    
                    if (slider && valueDisplay) {
                        slider.addEventListener('input', function() {
                            valueDisplay.textContent = this.value + '%';
                        });
                    }
                }
                
                setupQualitySlider('timelineQuality', 'timelineQualityValue');
                setupQualitySlider('albumQuality', 'albumQualityValue');
                setupQualitySlider('storyQuality', 'storyQualityValue');
                setupQualitySlider('momentQuality', 'momentQualityValue');
                setupQualitySlider('heroBgQuality', 'heroBgQualityValue');
                
                // Setup file uploads with compression
                function setupFileUpload(inputId, previewId, qualityId, multiple = false) {
                    const input = document.getElementById(inputId);
                    const preview = document.getElementById(previewId);
                    const qualitySlider = document.getElementById(qualityId);
                    
                    if (input && preview) {
                        input.addEventListener('change', async function() {
                            preview.innerHTML = '';
                            
                            if (this.files && this.files.length > 0) {
                                const quality = qualitySlider ? qualitySlider.value / 100 : 0.7;
                                
                                if (multiple) {
                                    const files = Array.from(this.files);
                                    const compressedPromises = files.map(file => compressImage(file, quality));
                                    const compressedImages = await Promise.all(compressedPromises);
                                    
                                    compressedImages.forEach(dataUrl => {
                                        const img = document.createElement('img');
                                        img.src = dataUrl;
                                        img.style.maxWidth = '100px';
                                        img.style.maxHeight = '100px';
                                        img.style.margin = '5px';
                                        img.style.borderRadius = '5px';
                                        img.style.objectFit = 'cover';
                                        preview.appendChild(img);
                                    });
                                } else {
                                    const compressedImage = await compressImage(this.files[0], quality);
                                    const img = document.createElement('img');
                                    img.src = compressedImage;
                                    preview.appendChild(img);
                                }
                            }
                        });
                    }
                }
                
                // Setup file uploads with compression
                setupFileUpload('timelineImage', 'timelineImagePreview', 'timelineQuality');
                setupFileUpload('albumPhotos', 'albumPhotosPreview', 'albumQuality', true);
                setupFileUpload('storyImage', 'storyImagePreview', 'storyQuality');
                setupFileUpload('momentImage', 'momentImagePreview', 'momentQuality');
                
                // Get compressed image data URL from file input
                async function getCompressedImageDataUrl(inputId, qualityId, multiple = false) {
                    const input = document.getElementById(inputId);
                    const qualitySlider = document.getElementById(qualityId);
                    const quality = qualitySlider ? qualitySlider.value / 100 : 0.7;
                    
                    if (multiple) {
                        if (input && input.files && input.files.length > 0) {
                            const files = Array.from(input.files);
                            const compressedPromises = files.map(file => compressImage(file, quality));
                            return Promise.all(compressedPromises);
                        } else {
                            return Promise.resolve([]);
                        }
                    } else {
                        if (input && input.files && input.files[0]) {
                            return compressImage(input.files[0], quality);
                        } else {
                            return Promise.resolve(null);
                        }
                    }
                }
                
                // Initialize data from Firebase or use default data
                let timelineData = [];
                let galleryData = [];
                let storiesData = [];
                let momentsData = [];
                
                // Default data jika Firebase tidak tersedia
                const defaultTimelineData = [
                    {
                        id: 1,
                        title: "Pertemuan Pertama",
                        date: "2023-01-01",
                        image: "https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        description: "Hari pertama kita bertemu, saat itu aku merasa ada yang berbeda dengan dirimu."
                    },
                    {
                        id: 2,
                        title: "Kencan Pertama",
                        date: "2023-01-15",
                        image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        description: "Kencan pertama kita di taman kota, menghabiskan waktu berjam-jam hanya untuk berbicara."
                    },
                    {
                        id: 3,
                        title: "Menjadi Pacar",
                        date: "2023-02-14",
                        image: "https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        description: "Hari Valentine yang tak terlupakan, saat kita resmi menjadi sepasang kekasih."
                    }
                ];
                
                const defaultGalleryData = [
                    {
                        id: 1,
                        title: "Liburan ke Bali",
                        date: "2023-03-10",
                        category: "perjalanan",
                        description: "Liburan pertama kita bersama ke pulau dewata",
                        photos: [
                            "https://images.unsplash.com/photo-1570077188670-e3a8d69ac5ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                            "https://images.unsplash.com/photo-1539367629965-3d5d7feb3588?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                            "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80"
                        ]
                    },
                    {
                        id: 2,
                        title: "Ulang Tahunku",
                        date: "2023-04-22",
                        category: "moment",
                        description: "Kejutan ulang tahun yang tak terlupakan",
                        photos: [
                            "https://images.unsplash.com/photo-1530103862676-de8c9debad1d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                            "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80"
                        ]
                    },
                    {
                        id: 3,
                        title: "Makan Malam Romantis",
                        date: "2023-05-20",
                        category: "moment",
                        description: "Makan malam di restoran tepi pantai",
                        photos: [
                            "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80"
                        ]
                    }
                ];
                
                const defaultStoriesData = [
                    {
                        id: 1,
                        title: "Kisah Cinta Kita",
                        date: "2023-02-14",
                        image: "https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        content: "Kisah kita dimulai dari pertemuan tak sengaja yang membawa banyak kenangan indah. Setiap hari bersamamu adalah anugerah yang tak terhingga. Aku bersyukur memiliki kamu di hidupku."
                    },
                    {
                        id: 2,
                        title: "Perjalanan Kita",
                        date: "2023-07-20",
                        image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        content: "Banyak tempat yang kita kunjungi bersama, dari pantai hingga gunung. Setiap perjalanan memiliki cerita tersendiri yang akan selalu kita kenang. Bersamamu, setiap tempat terasa lebih indah."
                    }
                ];
                
                const defaultMomentsData = [
                    {
                        id: 1,
                        title: "Anniversary Pertama",
                        date: "2024-02-14",
                        category: "Anniversary",
                        image: "https://images.unsplash.com/photo-1518176258769-ab22a57f0bf1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        description: "Satu tahun bersama, banyak kenangan yang telah kita lewati. Semoga kita terus bersama selamanya."
                    },
                    {
                        id: 2,
                        title: "Pertemuan Keluarga",
                        date: "2023-09-10",
                        category: "Keluarga",
                        image: "https://images.unsplash.com/photo-1511795409834-ef04bbd61622?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
                        description: "Momen penting saat kamu bertemu dengan keluargaku untuk pertama kalinya."
                    }
                ];
                
                // Load data from Firebase or use default data
                function loadDataFromFirebase() {
                    if (!firebaseInitialized || !database) {
                        // Jika Firebase tidak tersedia, gunakan data default
                        timelineData = [...defaultTimelineData];
                        galleryData = [...defaultGalleryData];
                        storiesData = [...defaultStoriesData];
                        momentsData = [...defaultMomentsData];
                        
                        renderTimeline();
                        renderGallery();
                        renderStories();
                        renderMoments();
                        return;
                    }
                    
                    // Load timeline data
                    database.ref('timeline').once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            if (data) {
                                timelineData = Object.values(data);
                            } else {
                                timelineData = [...defaultTimelineData];
                                // Save default data to Firebase
                                saveDataToFirebase();
                            }
                            renderTimeline();
                        })
                        .catch(error => {
                            console.error('Error loading timeline data:', error);
                            showToast('Gagal memuat data timeline. Menggunakan data default.', 'error');
                            timelineData = [...defaultTimelineData];
                            renderTimeline();
                        });
                    
                    // Load gallery data
                    database.ref('gallery').once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            if (data) {
                                galleryData = Object.values(data);
                            } else {
                                galleryData = [...defaultGalleryData];
                                // Save default data to Firebase
                                saveDataToFirebase();
                            }
                            renderGallery();
                        })
                        .catch(error => {
                            console.error('Error loading gallery data:', error);
                            showToast('Gagal memuat data galeri. Menggunakan data default.', 'error');
                            galleryData = [...defaultGalleryData];
                            renderGallery();
                        });
                    
                    // Load stories data
                    database.ref('stories').once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            if (data) {
                                storiesData = Object.values(data);
                            } else {
                                storiesData = [...defaultStoriesData];
                                // Save default data to Firebase
                                saveDataToFirebase();
                            }
                            renderStories();
                        })
                        .catch(error => {
                            console.error('Error loading stories data:', error);
                            showToast('Gagal memuat data cerita. Menggunakan data default.', 'error');
                            storiesData = [...defaultStoriesData];
                            renderStories();
                        });
                    
                    // Load moments data
                    database.ref('moments').once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            if (data) {
                                momentsData = Object.values(data);
                            } else {
                                momentsData = [...defaultMomentsData];
                                // Save default data to Firebase
                                saveDataToFirebase();
                            }
                            renderMoments();
                        })
                        .catch(error => {
                            console.error('Error loading moments data:', error);
                            showToast('Gagal memuat data momen. Menggunakan data default.', 'error');
                            momentsData = [...defaultMomentsData];
                            renderMoments();
                        });
                    
                    // Load settings
                    database.ref('settings').once('value')
                        .then(snapshot => {
                            const settings = snapshot.val();
                            if (settings) {
                                // Apply hero background if exists
                                if (settings.heroBackground && heroSection) {
                                    localStorage.setItem('heroBackground', settings.heroBackground);
                                    heroSection.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('${settings.heroBackground}')`;
                                }
                                
                                // Apply love start date if exists
                                if (settings.loveStartDate) {
                                    localStorage.setItem('loveStartDate', settings.loveStartDate);
                                    startDate = new Date(settings.loveStartDate);
                                }
                            }
                        })
                        .catch(error => {
                            console.error('Error loading settings:', error);
                        });
                }
                
                // Save data to Firebase
                function saveDataToFirebase() {
                    if (!firebaseInitialized || !database) {
                        console.log('Firebase not initialized, skipping save to Firebase');
                        return;
                    }
                    
                    // Save timeline data
                    database.ref('timeline').set(timelineData)
                        .then(() => {
                            console.log('Timeline data saved successfully');
                        })
                        .catch(error => {
                            console.error('Error saving timeline data:', error);
                            showToast('Gagal menyimpan data timeline.', 'error');
                        });
                    
                    // Save gallery data
                    database.ref('gallery').set(galleryData)
                        .then(() => {
                            console.log('Gallery data saved successfully');
                        })
                        .catch(error => {
                            console.error('Error saving gallery data:', error);
                            showToast('Gagal menyimpan data galeri.', 'error');
                        });
                    
                    // Save stories data
                    database.ref('stories').set(storiesData)
                        .then(() => {
                            console.log('Stories data saved successfully');
                        })
                        .catch(error => {
                            console.error('Error saving stories data:', error);
                            showToast('Gagal menyimpan data cerita.', 'error');
                        });
                    
                    // Save moments data
                    database.ref('moments').set(momentsData)
                        .then(() => {
                            console.log('Moments data saved successfully');
                        })
                        .catch(error => {
                            console.error('Error saving moments data:', error);
                            showToast('Gagal menyimpan data momen.', 'error');
                        });
                }
                
                // Sanitize input to prevent XSS
                function sanitizeInput(input) {
                    const div = document.createElement('div');
                    div.textContent = input;
                    return div.innerHTML;
                }
                
                // Render Timeline
                function renderTimeline() {
                    const timelineContainer = document.getElementById('timelineContainer');
                    if (!timelineContainer) return;
                    
                    timelineContainer.innerHTML = '';
                    
                    // Sort timeline by date
                    const sortedTimeline = [...timelineData].sort((a, b) => new Date(a.date) - new Date(b.date));
                    
                    sortedTimeline.forEach((item, index) => {
                        const timelineItem = document.createElement('div');
                        timelineItem.className = `timeline-item ${index % 2 === 0 ? 'left' : 'right'} fade-in`;
                        
                        let imageHtml = '';
                        if (item.image) {
                            imageHtml = `<img src="${item.image}" alt="${sanitizeInput(item.title)}" class="timeline-image">`;
                        }
                        
                        timelineItem.innerHTML = `
                            <div class="timeline-content">
                                <div class="timeline-date">${formatDate(item.date)}</div>
                                <h3>${sanitizeInput(item.title)}</h3>
                                ${imageHtml}
                                <p>${sanitizeInput(item.description)}</p>
                                ${adminStatus && adminStatus.classList.contains('active') ? `
                                    <div class="admin-actions">
                                        <button class="edit" data-id="${item.id}" data-type="timeline" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="delete" data-id="${item.id}" data-type="timeline" title="Hapus">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                        
                        timelineContainer.appendChild(timelineItem);
                    });
                    
                    // Add event listeners for edit and delete buttons
                    document.querySelectorAll('.timeline-item .edit').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            const item = timelineData.find(t => t.id === id);
                            if (item) {
                                const timelineTitle = document.getElementById('timelineTitle');
                                const timelineDate = document.getElementById('timelineDate');
                                const timelineDescription = document.getElementById('timelineDescription');
                                
                                if (timelineTitle) timelineTitle.value = item.title;
                                if (timelineDate) timelineDate.value = item.date;
                                
                                // Show image preview if exists
                                if (item.image) {
                                    const preview = document.getElementById('timelineImagePreview');
                                    if (preview) preview.innerHTML = `<img src="${item.image}" alt="Preview">`;
                                }
                                
                                if (timelineDescription) timelineDescription.value = item.description;
                                
                                // Change add button to update button
                                const addBtn = document.getElementById('addTimelineBtn');
                                if (addBtn) {
                                    addBtn.textContent = 'Update Timeline';
                                    addBtn.setAttribute('data-id', id);
                                }
                            }
                        });
                    });
                    
                    document.querySelectorAll('.timeline-item .delete').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            
                            // Konfirmasi sebelum menghapus
                            if (confirm('Apakah Anda yakin ingin menghapus timeline ini?')) {
                                timelineData = timelineData.filter(t => t.id !== id);
                                saveDataToFirebase();
                                renderTimeline();
                                showToast('Timeline berhasil dihapus.', 'success');
                            }
                        });
                    });
                    
                    // Trigger animation
                    setTimeout(() => {
                        document.querySelectorAll('.timeline-item').forEach(item => {
                            item.classList.add('show');
                        });
                    }, 100);
                }
                
                // Render Gallery
                function renderGallery(filter = 'all') {
                    const galleryContainer = document.getElementById('galleryContainer');
                    if (!galleryContainer) return;
                    
                    galleryContainer.innerHTML = '';
                    
                    // Sort gallery by date
                    const sortedGallery = [...galleryData].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    const filteredGallery = filter === 'all' 
                        ? sortedGallery 
                        : sortedGallery.filter(item => item.category === filter);
                    
                    filteredGallery.forEach(item => {
                        const galleryItem = document.createElement('div');
                        galleryItem.className = 'gallery-item fade-in';
                        galleryItem.setAttribute('data-category', item.category);
                        
                        // Use first photo as cover
                        const coverImage = item.photos && item.photos.length > 0 ? item.photos[0] : 'https://via.placeholder.com/400x300';
                        
                        galleryItem.innerHTML = `
                            <img src="${coverImage}" alt="${sanitizeInput(item.title)}" class="gallery-img">
                            <div class="gallery-info">
                                <h3 class="gallery-title">${sanitizeInput(item.title)}</h3>
                                <p class="gallery-date">${formatDate(item.date)}</p>
                            </div>
                            <div class="gallery-overlay">
                                <a href="#" class="view-btn" data-id="${item.id}">Lihat Detail</a>
                            </div>
                            ${adminStatus && adminStatus.classList.contains('active') ? `
                                <div class="admin-actions">
                                    <button class="edit" data-id="${item.id}" data-type="gallery" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete" data-id="${item.id}" data-type="gallery" title="Hapus">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            ` : ''}
                        `;
                        
                        galleryContainer.appendChild(galleryItem);
                    });
                    
                    // Add event listeners for view buttons
                    document.querySelectorAll('.view-btn').forEach(btn => {
                        btn.addEventListener('click', function(e) {
                            e.preventDefault();
                            const id = parseInt(this.getAttribute('data-id'));
                            const item = galleryData.find(g => g.id === id);
                            if (item) {
                                openGalleryDetail(item);
                            }
                        });
                    });
                    
                    // Add event listeners for edit and delete buttons
                    document.querySelectorAll('.gallery-item .edit').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            const item = galleryData.find(g => g.id === id);
                            if (item) {
                                const albumName = document.getElementById('albumName');
                                const albumDate = document.getElementById('albumDate');
                                const albumCategory = document.getElementById('albumCategory');
                                const albumDescription = document.getElementById('albumDescription');
                                
                                if (albumName) albumName.value = item.title;
                                if (albumDate) albumDate.value = item.date;
                                if (albumCategory) albumCategory.value = item.category;
                                if (albumDescription) albumDescription.value = item.description || '';
                                
                                // Show photos preview if exists
                                if (item.photos && item.photos.length > 0) {
                                    const preview = document.getElementById('albumPhotosPreview');
                                    if (preview) {
                                        preview.innerHTML = '';
                                        item.photos.forEach(photo => {
                                            const img = document.createElement('img');
                                            img.src = photo;
                                            img.style.maxWidth = '100px';
                                            img.style.maxHeight = '100px';
                                            img.style.margin = '5px';
                                            img.style.borderRadius = '5px';
                                            img.style.objectFit = 'cover';
                                            preview.appendChild(img);
                                        });
                                    }
                                }
                                
                                // Change add button to update button
                                const addBtn = document.getElementById('addAlbumBtn');
                                if (addBtn) {
                                    addBtn.textContent = 'Update Album';
                                    addBtn.setAttribute('data-id', id);
                                }
                            }
                        });
                    });
                    
                    document.querySelectorAll('.gallery-item .delete').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            
                            // Konfirmasi sebelum menghapus
                            if (confirm('Apakah Anda yakin ingin menghapus album ini?')) {
                                galleryData = galleryData.filter(g => g.id !== id);
                                saveDataToFirebase();
                                const activeFilter = document.querySelector('.filter-btn.active');
                                const filter = activeFilter ? activeFilter.getAttribute('data-filter') : 'all';
                                renderGallery(filter);
                                showToast('Album berhasil dihapus.', 'success');
                            }
                        });
                    });
                    
                    // Trigger animation
                    setTimeout(() => {
                        document.querySelectorAll('.gallery-item').forEach(item => {
                            item.classList.add('show');
                        });
                    }, 100);
                }
                
                // Gallery Detail Modal
                const galleryDetailModal = document.getElementById('galleryDetailModal');
                const closeGalleryDetail = document.getElementById('closeGalleryDetail');
                const galleryDetailTitle = document.getElementById('galleryDetailTitle');
                const galleryDetailDate = document.getElementById('galleryDetailDate');
                const galleryDetailDescription = document.getElementById('galleryDetailDescription');
                const galleryDetailPhotos = document.getElementById('galleryDetailPhotos');
                
                function openGalleryDetail(album) {
                    if (!galleryDetailModal || !galleryDetailTitle || !galleryDetailDate || !galleryDetailDescription || !galleryDetailPhotos) return;
                    
                    galleryDetailTitle.textContent = sanitizeInput(album.title);
                    galleryDetailDate.textContent = formatDate(album.date);
                    galleryDetailDescription.textContent = sanitizeInput(album.description || 'Tidak ada deskripsi');
                    
                    // Clear previous photos
                    galleryDetailPhotos.innerHTML = '';
                    
                    // Add photos
                    if (album.photos && album.photos.length > 0) {
                        album.photos.forEach((photo, index) => {
                            const photoItem = document.createElement('div');
                            photoItem.className = 'gallery-detail-photo';
                            
                            const img = document.createElement('img');
                            img.src = photo;
                            img.alt = `${sanitizeInput(album.title)} - Foto ${index + 1}`;
                            
                            // Add download button for admin
                            if (adminStatus && adminStatus.classList.contains('active')) {
                                const downloadBtn = document.createElement('button');
                                downloadBtn.className = 'download-btn';
                                downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
                                downloadBtn.title = 'Download Foto';
                                downloadBtn.addEventListener('click', function(e) {
                                    e.stopPropagation();
                                    downloadImage(photo, `${sanitizeInput(album.title)}_foto_${index + 1}`);
                                });
                                photoItem.appendChild(downloadBtn);
                            }
                            
                            photoItem.appendChild(img);
                            galleryDetailPhotos.appendChild(photoItem);
                            
                            // Add click event to open lightbox
                            photoItem.addEventListener('click', function() {
                                openLightbox(album.photos, index, album.title);
                            });
                        });
                    } else {
                        galleryDetailPhotos.innerHTML = '<p>Tidak ada foto dalam album ini.</p>';
                    }
                    
                    galleryDetailModal.classList.add('active');
                }
                
                if (closeGalleryDetail) {
                    closeGalleryDetail.addEventListener('click', function() {
                        if (galleryDetailModal) galleryDetailModal.classList.remove('active');
                    });
                }
                
                window.addEventListener('click', function(e) {
                    if (e.target === galleryDetailModal) {
                        if (galleryDetailModal) galleryDetailModal.classList.remove('active');
                    }
                });
                
                // Lightbox
                const lightbox = document.getElementById('lightbox');
                const lightboxClose = document.getElementById('lightboxClose');
                const lightboxImg = document.getElementById('lightboxImg');
                const lightboxCaption = document.getElementById('lightboxCaption');
                const lightboxPrev = document.getElementById('lightboxPrev');
                const lightboxNext = document.getElementById('lightboxNext');
                const lightboxDownload = document.getElementById('lightboxDownload');
                
                let currentLightboxImages = [];
                let currentLightboxIndex = 0;
                
                function openLightbox(images, index, albumTitle) {
                    if (!lightbox || !lightboxImg || !lightboxCaption) return;
                    
                    currentLightboxImages = images;
                    currentLightboxIndex = index;
                    
                    lightboxImg.src = images[index];
                    lightboxCaption.textContent = `${sanitizeInput(albumTitle)} - Foto ${index + 1} dari ${images.length}`;
                    
                    // Show/hide navigation buttons
                    if (lightboxPrev) lightboxPrev.style.display = images.length > 1 ? 'flex' : 'none';
                    if (lightboxNext) lightboxNext.style.display = images.length > 1 ? 'flex' : 'none';
                    
                    lightbox.classList.add('active');
                }
                
                function showPrevImage() {
                    if (currentLightboxIndex > 0) {
                        currentLightboxIndex--;
                        if (lightboxImg) lightboxImg.src = currentLightboxImages[currentLightboxIndex];
                        if (lightboxCaption) lightboxCaption.textContent = `Foto ${currentLightboxIndex + 1} dari ${currentLightboxImages.length}`;
                    }
                }
                
                function showNextImage() {
                    if (currentLightboxIndex < currentLightboxImages.length - 1) {
                        currentLightboxIndex++;
                        if (lightboxImg) lightboxImg.src = currentLightboxImages[currentLightboxIndex];
                        if (lightboxCaption) lightboxCaption.textContent = `Foto ${currentLightboxIndex + 1} dari ${currentLightboxImages.length}`;
                    }
                }
                
                if (lightboxPrev) lightboxPrev.addEventListener('click', showPrevImage);
                if (lightboxNext) lightboxNext.addEventListener('click', showNextImage);
                
                // Keyboard navigation
                document.addEventListener('keydown', function(e) {
                    if (lightbox && lightbox.classList.contains('active')) {
                        if (e.key === 'ArrowLeft') {
                            showPrevImage();
                        } else if (e.key === 'ArrowRight') {
                            showNextImage();
                        } else if (e.key === 'Escape') {
                            if (lightbox) lightbox.classList.remove('active');
                        }
                    }
                });
                
                // Download image function
                function downloadImage(src, filename) {
                    const link = document.createElement('a');
                    link.href = src;
                    link.download = sanitizeInput(filename || 'image');
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    showToast('Foto berhasil diunduh.', 'success');
                }
                
                // Lightbox download button
                if (lightboxDownload) {
                    lightboxDownload.addEventListener('click', function() {
                        if (currentLightboxImages.length > 0) {
                            const filename = `kenangan_kita_foto_${currentLightboxIndex + 1}`;
                            downloadImage(currentLightboxImages[currentLightboxIndex], filename);
                        }
                    });
                }
                
                if (lightboxClose) {
                    lightboxClose.addEventListener('click', function() {
                        if (lightbox) lightbox.classList.remove('active');
                    });
                }
                
                window.addEventListener('click', function(e) {
                    if (e.target === lightbox) {
                        if (lightbox) lightbox.classList.remove('active');
                    }
                });
                
                // Render Stories
                function renderStories() {
                    const storiesContainer = document.getElementById('storiesContainer');
                    if (!storiesContainer) return;
                    
                    storiesContainer.innerHTML = '';
                    
                    // Sort stories by date
                    const sortedStories = [...storiesData].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    sortedStories.forEach(item => {
                        const storyCard = document.createElement('div');
                        storyCard.className = 'story-card fade-in';
                        
                        let imageHtml = '';
                        if (item.image) {
                            imageHtml = `<img src="${item.image}" alt="${sanitizeInput(item.title)}" class="story-image">`;
                        }
                        
                        storyCard.innerHTML = `
                            <div class="story-header">
                                <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=687&q=80" alt="Avatar" class="story-avatar">
                                <div class="story-meta">
                                    <h3>${sanitizeInput(item.title)}</h3>
                                    <p class="story-date">${formatDate(item.date)}</p>
                                </div>
                            </div>
                            ${imageHtml}
                            <div class="story-content">
                                <p>${sanitizeInput(item.content)}</p>
                            </div>
                            ${adminStatus && adminStatus.classList.contains('active') ? `
                                <div class="admin-actions">
                                    <button class="edit" data-id="${item.id}" data-type="story" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete" data-id="${item.id}" data-type="story" title="Hapus">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            ` : ''}
                        `;
                        
                        storiesContainer.appendChild(storyCard);
                    });
                    
                    // Add event listeners for edit and delete buttons
                    document.querySelectorAll('.story-card .edit').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            const item = storiesData.find(s => s.id === id);
                            if (item) {
                                const storyTitle = document.getElementById('storyTitle');
                                const storyDate = document.getElementById('storyDate');
                                const storyContent = document.getElementById('storyContent');
                                
                                if (storyTitle) storyTitle.value = item.title;
                                if (storyDate) storyDate.value = item.date;
                                
                                // Show image preview if exists
                                if (item.image) {
                                    const preview = document.getElementById('storyImagePreview');
                                    if (preview) preview.innerHTML = `<img src="${item.image}" alt="Preview">`;
                                }
                                
                                if (storyContent) storyContent.value = item.content;
                                
                                // Change add button to update button
                                const addBtn = document.getElementById('addStoryBtn');
                                if (addBtn) {
                                    addBtn.textContent = 'Update Cerita';
                                    addBtn.setAttribute('data-id', id);
                                }
                            }
                        });
                    });
                    
                    document.querySelectorAll('.story-card .delete').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            
                            // Konfirmasi sebelum menghapus
                            if (confirm('Apakah Anda yakin ingin menghapus cerita ini?')) {
                                storiesData = storiesData.filter(s => s.id !== id);
                                saveDataToFirebase();
                                renderStories();
                                showToast('Cerita berhasil dihapus.', 'success');
                            }
                        });
                    });
                    
                    // Trigger animation
                    setTimeout(() => {
                        document.querySelectorAll('.story-card').forEach(item => {
                            item.classList.add('show');
                        });
                    }, 100);
                }
                
                // Render Moments
                function renderMoments() {
                    const momentsContainer = document.getElementById('momentsContainer');
                    if (!momentsContainer) return;
                    
                    momentsContainer.innerHTML = '';
                    
                    // Sort moments by date
                    const sortedMoments = [...momentsData].sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    sortedMoments.forEach(item => {
                        const momentCard = document.createElement('div');
                        momentCard.className = 'moment-card fade-in';
                        
                        momentCard.innerHTML = `
                            <img src="${item.image}" alt="${sanitizeInput(item.title)}" class="moment-img">
                            <div class="moment-content">
                                <h3 class="moment-title">${sanitizeInput(item.title)}</h3>
                                <p class="moment-date">${formatDate(item.date)}</p>
                                <span class="moment-category">${sanitizeInput(item.category)}</span>
                                <p class="moment-description">${sanitizeInput(item.description)}</p>
                                <a href="#" class="moment-link" data-id="${item.id}">Selengkapnya <i class="fas fa-arrow-right"></i></a>
                                ${adminStatus && adminStatus.classList.contains('active') ? `
                                    <div class="admin-actions">
                                        <button class="edit" data-id="${item.id}" data-type="moment" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="delete" data-id="${item.id}" data-type="moment" title="Hapus">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                        
                        momentsContainer.appendChild(momentCard);
                    });
                    
                    // Add event listeners for detail links
                    document.querySelectorAll('.moment-link').forEach(link => {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            const id = parseInt(this.getAttribute('data-id'));
                            const item = momentsData.find(m => m.id === id);
                            if (item) {
                                openLightbox([item.image], 0, item.title);
                            }
                        });
                    });
                    
                    // Add event listeners for edit and delete buttons
                    document.querySelectorAll('.moment-card .edit').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            const item = momentsData.find(m => m.id === id);
                            if (item) {
                                const momentTitle = document.getElementById('momentTitle');
                                const momentDate = document.getElementById('momentDate');
                                const momentCategory = document.getElementById('momentCategory');
                                const momentDescription = document.getElementById('momentDescription');
                                
                                if (momentTitle) momentTitle.value = item.title;
                                if (momentDate) momentDate.value = item.date;
                                if (momentCategory) momentCategory.value = item.category;
                                
                                // Show image preview if exists
                                if (item.image) {
                                    const preview = document.getElementById('momentImagePreview');
                                    if (preview) preview.innerHTML = `<img src="${item.image}" alt="Preview">`;
                                }
                                
                                if (momentDescription) momentDescription.value = item.description;
                                
                                // Change add button to update button
                                const addBtn = document.getElementById('addMomentBtn');
                                if (addBtn) {
                                    addBtn.textContent = 'Update Momen';
                                    addBtn.setAttribute('data-id', id);
                                }
                            }
                        });
                    });
                    
                    document.querySelectorAll('.moment-card .delete').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const id = parseInt(this.getAttribute('data-id'));
                            
                            // Konfirmasi sebelum menghapus
                            if (confirm('Apakah Anda yakin ingin menghapus momen ini?')) {
                                momentsData = momentsData.filter(m => m.id !== id);
                                saveDataToFirebase();
                                renderMoments();
                                showToast('Momen berhasil dihapus.', 'success');
                            }
                        });
                    });
                    
                    // Trigger animation
                    setTimeout(() => {
                        document.querySelectorAll('.moment-card').forEach(item => {
                            item.classList.add('show');
                        });
                    }, 100);
                }
                
                // Format Date
                function formatDate(dateString) {
                    const options = { year: 'numeric', month: 'long', day: 'numeric' };
                    return new Date(dateString).toLocaleDateString('id-ID', options);
                }
                
                // Gallery Filter
                const filterBtns = document.querySelectorAll('.filter-btn');
                
                if (filterBtns) {
                    filterBtns.forEach(btn => {
                        btn.addEventListener('click', function() {
                            // Update active state
                            filterBtns.forEach(b => b.classList.remove('active'));
                            this.classList.add('active');
                            
                            // Filter gallery
                            const filter = this.getAttribute('data-filter');
                            renderGallery(filter);
                        });
                    });
                }
                
                // Add Timeline
                const addTimelineBtn = document.getElementById('addTimelineBtn');
                if (addTimelineBtn) {
                    addTimelineBtn.addEventListener('click', async function() {
                        const timelineTitle = document.getElementById('timelineTitle');
                        const timelineDate = document.getElementById('timelineDate');
                        const timelineDescription = document.getElementById('timelineDescription');
                        
                        const title = timelineTitle ? timelineTitle.value.trim() : '';
                        const date = timelineDate ? timelineDate.value : '';
                        const description = timelineDescription ? timelineDescription.value.trim() : '';
                        
                        // Input validation
                        if (!title || !date || !description) {
                            showToast('Harap isi semua field!', 'error');
                            return;
                        }
                        
                        // Get compressed image data URL
                        const image = await getCompressedImageDataUrl('timelineImage', 'timelineQuality');
                        
                        const id = this.getAttribute('data-id');
                        
                        if (id) {
                            // Update existing timeline
                            const index = timelineData.findIndex(t => t.id === parseInt(id));
                            if (index !== -1) {
                                timelineData[index] = {
                                    id: parseInt(id),
                                    title: sanitizeInput(title),
                                    date,
                                    image: image || timelineData[index].image,
                                    description: sanitizeInput(description)
                                };
                                showToast('Timeline berhasil diperbarui.', 'success');
                            }
                            
                            // Reset button
                            this.textContent = 'Tambah Timeline';
                            this.removeAttribute('data-id');
                        } else {
                            // Generate new ID
                            const newId = timelineData.length > 0 ? Math.max(...timelineData.map(t => t.id)) + 1 : 1;
                            
                            // Add new timeline
                            const newTimeline = {
                                id: newId,
                                title: sanitizeInput(title),
                                date,
                                image,
                                description: sanitizeInput(description)
                            };
                            
                            timelineData.push(newTimeline);
                            showToast('Timeline berhasil ditambahkan.', 'success');
                        }
                        
                        // Save to Firebase
                        saveDataToFirebase();
                        
                        // Clear form
                        if (timelineTitle) timelineTitle.value = '';
                        if (timelineDate) timelineDate.value = '';
                        const timelineImage = document.getElementById('timelineImage');
                        if (timelineImage) timelineImage.value = '';
                        const timelineImagePreview = document.getElementById('timelineImagePreview');
                        if (timelineImagePreview) timelineImagePreview.innerHTML = '';
                        if (timelineDescription) timelineDescription.value = '';
                        
                        // Re-render timeline
                        renderTimeline();
                    });
                }
                
                // Cancel Timeline
                const cancelTimelineBtn = document.getElementById('cancelTimelineBtn');
                if (cancelTimelineBtn) {
                    cancelTimelineBtn.addEventListener('click', function() {
                        const timelineTitle = document.getElementById('timelineTitle');
                        const timelineDate = document.getElementById('timelineDate');
                        const timelineImage = document.getElementById('timelineImage');
                        const timelineImagePreview = document.getElementById('timelineImagePreview');
                        const timelineDescription = document.getElementById('timelineDescription');
                        
                        if (timelineTitle) timelineTitle.value = '';
                        if (timelineDate) timelineDate.value = '';
                        if (timelineImage) timelineImage.value = '';
                        if (timelineImagePreview) timelineImagePreview.innerHTML = '';
                        if (timelineDescription) timelineDescription.value = '';
                        
                        // Reset button
                        const addBtn = document.getElementById('addTimelineBtn');
                        if (addBtn) {
                            addBtn.textContent = 'Tambah Timeline';
                            addBtn.removeAttribute('data-id');
                        }
                    });
                }
                
                // Add Album
                const addAlbumBtn = document.getElementById('addAlbumBtn');
                if (addAlbumBtn) {
                    addAlbumBtn.addEventListener('click', async function() {
                        const albumName = document.getElementById('albumName');
                        const albumDate = document.getElementById('albumDate');
                        const albumCategory = document.getElementById('albumCategory');
                        const albumDescription = document.getElementById('albumDescription');
                        
                        const title = albumName ? albumName.value.trim() : '';
                        const date = albumDate ? albumDate.value : '';
                        const category = albumCategory ? albumCategory.value : '';
                        const description = albumDescription ? albumDescription.value.trim() : '';
                        
                        // Input validation
                        if (!title || !date) {
                            showToast('Harap isi semua field!', 'error');
                            return;
                        }
                        
                        // Get compressed photos data URLs
                        const photos = await getCompressedImageDataUrl('albumPhotos', 'albumQuality', true);
                        
                        if (photos.length === 0) {
                            showToast('Harap pilih minimal satu foto!', 'error');
                            return;
                        }
                        
                        const id = this.getAttribute('data-id');
                        
                        if (id) {
                            // Update existing album
                            const index = galleryData.findIndex(g => g.id === parseInt(id));
                            if (index !== -1) {
                                galleryData[index] = {
                                    id: parseInt(id),
                                    title: sanitizeInput(title),
                                    date,
                                    category,
                                    description: sanitizeInput(description),
                                    photos: photos.length > 0 ? photos : galleryData[index].photos
                                };
                                showToast('Album berhasil diperbarui.', 'success');
                            }
                            
                            // Reset button
                            this.textContent = 'Tambah Album';
                            this.removeAttribute('data-id');
                        } else {
                            // Generate new ID
                            const newId = galleryData.length > 0 ? Math.max(...galleryData.map(g => g.id)) + 1 : 1;
                            
                            // Add new album
                            const newAlbum = {
                                id: newId,
                                title: sanitizeInput(title),
                                date,
                                category,
                                description: sanitizeInput(description),
                                photos
                            };
                            
                            galleryData.push(newAlbum);
                            showToast('Album berhasil ditambahkan.', 'success');
                        }
                        
                        // Save to Firebase
                        saveDataToFirebase();
                        
                        // Clear form
                        if (albumName) albumName.value = '';
                        if (albumDate) albumDate.value = '';
                        if (albumCategory) albumCategory.value = 'perjalanan';
                        if (albumDescription) albumDescription.value = '';
                        const albumPhotos = document.getElementById('albumPhotos');
                        if (albumPhotos) albumPhotos.value = '';
                        const albumPhotosPreview = document.getElementById('albumPhotosPreview');
                        if (albumPhotosPreview) albumPhotosPreview.innerHTML = '';
                        
                        // Re-render gallery
                        const activeFilter = document.querySelector('.filter-btn.active');
                        const filter = activeFilter ? activeFilter.getAttribute('data-filter') : 'all';
                        renderGallery(filter);
                    });
                }
                
                // Cancel Album
                const cancelAlbumBtn = document.getElementById('cancelAlbumBtn');
                if (cancelAlbumBtn) {
                    cancelAlbumBtn.addEventListener('click', function() {
                        const albumName = document.getElementById('albumName');
                        const albumDate = document.getElementById('albumDate');
                        const albumCategory = document.getElementById('albumCategory');
                        const albumDescription = document.getElementById('albumDescription');
                        const albumPhotos = document.getElementById('albumPhotos');
                        const albumPhotosPreview = document.getElementById('albumPhotosPreview');
                        
                        if (albumName) albumName.value = '';
                        if (albumDate) albumDate.value = '';
                        if (albumCategory) albumCategory.value = 'perjalanan';
                        if (albumDescription) albumDescription.value = '';
                        if (albumPhotos) albumPhotos.value = '';
                        if (albumPhotosPreview) albumPhotosPreview.innerHTML = '';
                        
                        // Reset button
                        const addBtn = document.getElementById('addAlbumBtn');
                        if (addBtn) {
                            addBtn.textContent = 'Tambah Album';
                            addBtn.removeAttribute('data-id');
                        }
                    });
                }
                
                // Add Story
                const addStoryBtn = document.getElementById('addStoryBtn');
                if (addStoryBtn) {
                    addStoryBtn.addEventListener('click', async function() {
                        const storyTitle = document.getElementById('storyTitle');
                        const storyDate = document.getElementById('storyDate');
                        const storyContent = document.getElementById('storyContent');
                        
                        const title = storyTitle ? storyTitle.value.trim() : '';
                        const date = storyDate ? storyDate.value : '';
                        const content = storyContent ? storyContent.value.trim() : '';
                        
                        // Input validation
                        if (!title || !date || !content) {
                            showToast('Harap isi semua field kecuali gambar!', 'error');
                            return;
                        }
                        
                        // Get compressed image data URL
                        const image = await getCompressedImageDataUrl('storyImage', 'storyQuality');
                        
                        const id = this.getAttribute('data-id');
                        
                        if (id) {
                            // Update existing story
                            const index = storiesData.findIndex(s => s.id === parseInt(id));
                            if (index !== -1) {
                                storiesData[index] = {
                                    id: parseInt(id),
                                    title: sanitizeInput(title),
                                    date,
                                    image: image || storiesData[index].image,
                                    content: sanitizeInput(content)
                                };
                                showToast('Cerita berhasil diperbarui.', 'success');
                            }
                            
                            // Reset button
                            this.textContent = 'Tambah Cerita';
                            this.removeAttribute('data-id');
                        } else {
                            // Generate new ID
                            const newId = storiesData.length > 0 ? Math.max(...storiesData.map(s => s.id)) + 1 : 1;
                            
                            // Add new story
                            const newStory = {
                                id: newId,
                                title: sanitizeInput(title),
                                date,
                                image,
                                content: sanitizeInput(content)
                            };
                            
                            storiesData.push(newStory);
                            showToast('Cerita berhasil ditambahkan.', 'success');
                        }
                        
                        // Save to Firebase
                        saveDataToFirebase();
                        
                        // Clear form
                        if (storyTitle) storyTitle.value = '';
                        if (storyDate) storyDate.value = '';
                        const storyImage = document.getElementById('storyImage');
                        if (storyImage) storyImage.value = '';
                        const storyImagePreview = document.getElementById('storyImagePreview');
                        if (storyImagePreview) storyImagePreview.innerHTML = '';
                        if (storyContent) storyContent.value = '';
                        
                        // Re-render stories
                        renderStories();
                    });
                }
                
                // Cancel Story
                const cancelStoryBtn = document.getElementById('cancelStoryBtn');
                if (cancelStoryBtn) {
                    cancelStoryBtn.addEventListener('click', function() {
                        const storyTitle = document.getElementById('storyTitle');
                        const storyDate = document.getElementById('storyDate');
                        const storyImage = document.getElementById('storyImage');
                        const storyImagePreview = document.getElementById('storyImagePreview');
                        const storyContent = document.getElementById('storyContent');
                        
                        if (storyTitle) storyTitle.value = '';
                        if (storyDate) storyDate.value = '';
                        if (storyImage) storyImage.value = '';
                        if (storyImagePreview) storyImagePreview.innerHTML = '';
                        if (storyContent) storyContent.value = '';
                        
                        // Reset button
                        const addBtn = document.getElementById('addStoryBtn');
                        if (addBtn) {
                            addBtn.textContent = 'Tambah Cerita';
                            addBtn.removeAttribute('data-id');
                        }
                    });
                }
                
                // Add Moment
                const addMomentBtn = document.getElementById('addMomentBtn');
                if (addMomentBtn) {
                    addMomentBtn.addEventListener('click', async function() {
                        const momentTitle = document.getElementById('momentTitle');
                        const momentDate = document.getElementById('momentDate');
                        const momentCategory = document.getElementById('momentCategory');
                        const momentDescription = document.getElementById('momentDescription');
                        
                        const title = momentTitle ? momentTitle.value.trim() : '';
                        const date = momentDate ? momentDate.value : '';
                        const category = momentCategory ? momentCategory.value.trim() : '';
                        const description = momentDescription ? momentDescription.value.trim() : '';
                        
                        // Input validation
                        if (!title || !date || !description) {
                            showToast('Harap isi semua field!', 'error');
                            return;
                        }
                        
                        // Get compressed image data URL
                        const image = await getCompressedImageDataUrl('momentImage', 'momentQuality');
                        
                        if (!image) {
                            showToast('Harap pilih gambar!', 'error');
                            return;
                        }
                        
                        const id = this.getAttribute('data-id');
                        
                        if (id) {
                            // Update existing moment
                            const index = momentsData.findIndex(m => m.id === parseInt(id));
                            if (index !== -1) {
                                momentsData[index] = {
                                    id: parseInt(id),
                                    title: sanitizeInput(title),
                                    date,
                                    category: sanitizeInput(category),
                                    image,
                                    description: sanitizeInput(description)
                                };
                                showToast('Momen berhasil diperbarui.', 'success');
                            }
                            
                            // Reset button
                            this.textContent = 'Tambah Momen';
                            this.removeAttribute('data-id');
                        } else {
                            // Generate new ID
                            const newId = momentsData.length > 0 ? Math.max(...momentsData.map(m => m.id)) + 1 : 1;
                            
                            // Add new moment
                            const newMoment = {
                                id: newId,
                                title: sanitizeInput(title),
                                date,
                                category: sanitizeInput(category),
                                image,
                                description: sanitizeInput(description)
                            };
                            
                            momentsData.push(newMoment);
                            showToast('Momen berhasil ditambahkan.', 'success');
                        }
                        
                        // Save to Firebase
                        saveDataToFirebase();
                        
                        // Clear form
                        if (momentTitle) momentTitle.value = '';
                        if (momentDate) momentDate.value = '';
                        if (momentCategory) momentCategory.value = '';
                        const momentImage = document.getElementById('momentImage');
                        if (momentImage) momentImage.value = '';
                        const momentImagePreview = document.getElementById('momentImagePreview');
                        if (momentImagePreview) momentImagePreview.innerHTML = '';
                        if (momentDescription) momentDescription.value = '';
                        
                        // Re-render moments
                        renderMoments();
                    });
                }
                
                // Cancel Moment
                const cancelMomentBtn = document.getElementById('cancelMomentBtn');
                if (cancelMomentBtn) {
                    cancelMomentBtn.addEventListener('click', function() {
                        const momentTitle = document.getElementById('momentTitle');
                        const momentDate = document.getElementById('momentDate');
                        const momentCategory = document.getElementById('momentCategory');
                        const momentImage = document.getElementById('momentImage');
                        const momentImagePreview = document.getElementById('momentImagePreview');
                        const momentDescription = document.getElementById('momentDescription');
                        
                        if (momentTitle) momentTitle.value = '';
                        if (momentDate) momentDate.value = '';
                        if (momentCategory) momentCategory.value = '';
                        if (momentImage) momentImage.value = '';
                        if (momentImagePreview) momentImagePreview.innerHTML = '';
                        if (momentDescription) momentDescription.value = '';
                        
                        // Reset button
                        const addBtn = document.getElementById('addMomentBtn');
                        if (addBtn) {
                            addBtn.textContent = 'Tambah Momen';
                            addBtn.removeAttribute('data-id');
                        }
                    });
                }
                
                // Initialize page
                loadDataFromFirebase();
                
                // Fade in animation on scroll
                const fadeElements = document.querySelectorAll('.fade-in');
                
                function checkFade() {
                    fadeElements.forEach(element => {
                        const elementTop = element.getBoundingClientRect().top;
                        const elementVisible = 150;
                        
                        if (elementTop < window.innerHeight - elementVisible) {
                            element.classList.add('show');
                        }
                    });
                }
                
                window.addEventListener('scroll', checkFade);
                checkFade();
                
                // Security: Prevent right-click on images to protect content
                document.addEventListener('contextmenu', function(e) {
                    if (e.target.tagName === 'IMG') {
                        e.preventDefault();
                    }
                });
                
                // Security: Prevent drag and drop of images
                document.addEventListener('dragstart', function(e) {
                    if (e.target.tagName === 'IMG') {
                        e.preventDefault();
                    }
                });
                
                // Compress image function
                function compressImage(file, quality) {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.readAsDataURL(file);
                        reader.onload = function(event) {
                            const img = new Image();
                            img.src = event.target.result;
                            img.onload = function() {
                                const canvas = document.createElement('canvas');
                                const ctx = canvas.getContext('2d');
                                
                                // Calculate new dimensions
                                let width = img.width;
                                let height = img.height;
                                const maxSize = 1200;
                                
                                if (width > height) {
                                    if (width > maxSize) {
                                        height *= maxSize / width;
                                        width = maxSize;
                                    }
                                } else {
                                    if (height > maxSize) {
                                        width *= maxSize / height;
                                        height = maxSize;
                                    }
                                }
                                
                                canvas.width = width;
                                canvas.height = height;
                                
                                // Draw image on canvas
                                ctx.drawImage(img, 0, 0, width, height);
                                
                                // Get compressed data URL
                                const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                                resolve(compressedDataUrl);
                            };
                            img.onerror = function(error) {
                                reject(error);
                            };
                        };
                        reader.onerror = function(error) {
                            reject(error);
                        };
                    });
                }
            }
        });
    </script>
</body>
</html>